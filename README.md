# TCOS.lang (Timed and Concurrent Operational Semantics)

 * [Overview](##overview)
 * Usage
    * [As a Language Engineer](###asalanguageengineer)
    * [As a (Meta) Developper](###asa(meta)developper)


## Overview

TCOS is an open source language engineering tool. It provides a domain specific (meta) language for the definition of programmning language's behavioural semantics.

TCOS is particularly appropriate to programming languages embeeding concurrency and timing aspects. 

A TCOS specification is linked to a [(Langium) BNF](https://langium.org/) and specifies how to execute programs conforming the imported BNF.

A TCOS specification is amenable to the automatic generation of a compiler (tranpiler) for the imported language. Resulting code is free of any TCOS related library and can easily be embedded.

A main difference between TCOS and other language for behavioral semantics specification, is that it reifies the notion of *events* and *clocks* to ease the specification of timed and concurrent semantics. These notions are used to make explicit the control flow in a program instead of using pattern matching.

The project is still in infancy phase and is continously evolving.

If you're interested by any aspect of this language, please contact me, create issues or fork as wished.

If you're curious to see what a very simple TCOS specification looks like, see [./examples/languages/parLang.sos](./examples/languages/parLang.sos)

A more advanced example can be found [here]([./examples/languages/testFSE.sos]). Some others are in the pipes.

Below is a picture overviewing the architecture of the TCOS tooling.

![TCOS tooling overview](./docs/figures/TCOS_overview2.png)

## Usage

### As a Language Engineer

TCOS is implemented in TypeScript and distributed as a VS-Code extension. checkout the code and starta vscode in the ```sos``` folder. ```npm i```, ```npm run build``` and ```F5``` will start a VS-Code with the TCOS extension deployed. If you want to use the example, open the [./examples/languages/](./examples/languages/) folder in the started VS-Code. It contains subfolders that contain *LSP ready Langium based grammar definition* (```npm i; npm run langium:generate; npm run build``` in subfolders to install the grammar, parser and editors). The folders have been initially generated by using the ```yo langium``` wizard.

The semantics definitions are for now at the root of the [./examples/languages/](./examples/languages/) folder. Their extension is *.sos*.

Below is a example of a langium grammar file and a corresponding TCOS semantics file. On the left side, the grammar, given in the Langium BNF format is provided. On the right side, the TCOS file is provided. A TCOS semantics has a name. Then it imports a langium grammar, which it decorates with rules defining the semantics. For instance line 5 to 13, the ```Program``` concept from the grammar is reopened and two rules are woven in it. Rule can navigate to attributes defined in the grammar (like the ```stmt``` attribute, defined in the grammar line 4 and used lines 8 and 10 in the TCOs file).

This README does not define all the TCOS syntax but to give the flavor, the two first rules (defined lines 6 to 8 and 10 to 12) should be understood as 
> rule 1: when the semantics evaluation of a *Program* AST node *starts*, then the node *stmt* should be started in the same context Ïƒ.
> rule2: when the semantics evaluation of the *stmt* AST node *terminates*, then the associated program node terminates too.  

![screenshot of parlang syntax and semantics](./docs/screenshots/parLangScreenShot_annotated.png)

Once the semantics is defined, the compiler front end can be generated by running: `node ../../sos/bin/cli.js generate parLang.sos -d ParLang/`. This generates the following file: `ParLang/src/cli/generated/parLang.ts`

This file contains the code to generate a Concurrent Control Flow Graph (CCFG) from any ParLang program. In order to test it, compile it (`npm run build` in the ParLang folder) and launch a new VS-Code extension that contains the extension for the Parlang editor and compiler. In the new VS-Code instance, open the [./examples/programs/](./examples/programs/) folder.

Below is an example of a ParLang program with the corresponding CCFG. The CCFG (and the C++ code) have been obtained by running: `node ../languages/ParLang/bin/cli.js generate test1.parlang`. Explanantions are not provided in this README by one can see that: 1) the program never terminates (its terminates node, on the right in the picture is not reachable from the start node); and 2) there is a cycle (initiated in the blue node).

![A ParLang program and its CCFG](./docs/screenshots/parLangScreenShotProgramAndCCFG.png)

The dot file and the generated C++ code are provided in the `generated` folder. the generated code compile the easiest way: `g++ test1.cpp -o test1.exe`. These generated artefacts can be found in the [./examples/programs/generated](./examples/programs/generated) folder


### As a (Meta) Developper

TO BE DEFINED